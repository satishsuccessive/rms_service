"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const express = require("express");
const bodyParser = require("body-parser");
const config_1 = require("./config");
const auth_1 = require("../auth");
const authManager = auth_1.AuthManager.getInstance();
authManager.init(config_1.default.authProvider);
const app = express();
app.use(bodyParser.urlencoded({
    extended: true
}));
app.use(bodyParser.json());
app.use(authManager.auth);
const TEST_APIS = 10;
for (let i = 0; i < TEST_APIS; i++) { //creating dummy apis to test rules
    const url = `/api/test${i}`;
    app.get(url, (req, res) => {
        res.status(200).send({
            userId: res.locals.userId,
            userRoles: res.locals.userRoles
        });
    });
    app.post(url, (req, res) => {
        res.status(200).send({
            userId: res.locals.userId,
            userRoles: res.locals.userRoles
        });
    });
}
const server = app.listen(config_1.default.testerServerPort, () => {
    console.log(`Test server listening on port ${config_1.default.testerServerPort}`);
});
exports.default = server;
//# sourceMappingURL=index.js.map